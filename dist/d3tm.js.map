{"version":3,"sources":["../d3tm.js"],"names":["projectName","localStorage","setItem","rem2px","rem","parseFloat","getComputedStyle","document","documentElement","fontSize","FILES","kickstarter","title","url","movie","game","getElementById","description","legendSize","offset","xOffset","yOffset","rectSize","hSpacing","vSpacing","svgChart","d3","select","width","attr","height","body","legend","legendWidth","tooltip","append","style","d3Process","data","color","scaleOrdinal","range","schemeCategory10","map","c","interpolateRgb","format","treemap","size","paddingInner","innerHTML","name","showTooltip","d","value","event","pageX","pageY","html","category","hideTooltip","root","hierarchy","eachBefore","id","parent","sum","sort","a","b","cell","selectAll","leaves","enter","x0","y0","x1","y1","on","split","i","text","categories","nodes","filter","index","self","indexOf","legendElementsPerRow","Math","floor","legendElement","createChart","query","json","then","links","getElementsByClassName","Array","from","forEach","element","addEventListener","e","preventDefault","targetDataUrl","URL","target","href","newQuery","searchParams","get","remove","queryUrl","window","location","dataQuery"],"mappings":"AAAA;;AACA,IAAMA,WAAW,GAAG,UAApB;AACAC,YAAY,CAACC,OAAb,CAAqB,iBAArB,EAAwC,cAAxC;;AAEA,IAAMC,MAAM,GAAG,SAATA,MAAS,CAACC,GAAD;AAAA,SAAUA,GAAG,GAAGC,UAAU,CAACC,gBAAgB,CAACC,QAAQ,CAACC,eAAV,CAAhB,CAA2CC,QAA5C,CAA1B;AAAA,CAAf;;AAEA,IAAMC,KAAK,GAAG;AACZC,EAAAA,WAAW,EAAE;AACXC,IAAAA,KAAK,EAAE,qBADI;AAEXC,IAAAA,GAAG,EAAE;AAFM,GADD;AAKZC,EAAAA,KAAK,EAAE;AACLF,IAAAA,KAAK,EAAE,aADF;AAELC,IAAAA,GAAG,EAAE;AAFA,GALK;AASZE,EAAAA,IAAI,EAAE;AACJH,IAAAA,KAAK,EAAE,kBADH;AAEJC,IAAAA,GAAG,EAAE;AAFD;AATM,CAAd;AAeA,IAAMD,KAAK,GAAGL,QAAQ,CAACS,cAAT,CAAwB,OAAxB,CAAd;AAAA,IACIC,WAAW,GAAGV,QAAQ,CAACS,cAAT,CAAwB,aAAxB,CADlB;AAAA,IAEIE,UAAU,GAAG;AACXC,EAAAA,MAAM,EAAEhB,MAAM,CAAC,GAAD,CADH;AAEXiB,EAAAA,OAAO,EAAE,CAFE;AAGXC,EAAAA,OAAO,EAAE,CAAC,CAHC;AAIXC,EAAAA,QAAQ,EAAEnB,MAAM,CAAC,GAAD,CAJL;AAKXoB,EAAAA,QAAQ,EAAEpB,MAAM,CAAC,EAAD,CALL;AAMXqB,EAAAA,QAAQ,EAAErB,MAAM,CAAC,GAAD;AANL,CAFjB;AAWA,IAAIsB,QAAQ,GAAGC,EAAE,CAACC,MAAH,CAAU,WAAV,CAAf;AAAA,IACIC,KAAK,GAAG,CAACH,QAAQ,CAACI,IAAT,CAAc,OAAd,CADb;AAAA,IAEIC,MAAM,GAAG,CAACL,QAAQ,CAACI,IAAT,CAAc,QAAd,CAFd;AAAA,IAGIE,IAAI,GAAGL,EAAE,CAACC,MAAH,CAAU,MAAV,CAHX;AAAA,IAIIK,MAAM,GAAGN,EAAE,CAACC,MAAH,CAAU,SAAV,CAJb;AAAA,IAKIM,WAAW,GAAG,CAACD,MAAM,CAACH,IAAP,CAAY,OAAZ,CALnB;AAOA,IAAIK,OAAO,GAAGH,IAAI,CAACI,MAAL,CAAY,KAAZ,EACTN,IADS,CACJ,IADI,EACE,SADF,EAETO,KAFS,CAEH,SAFG,EAEQ,CAFR,CAAd;;AAKA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,IAAD,EAAU;AAC1B,MAAMC,KAAK,GAAGb,EAAE,CAACc,YAAH,GACLC,KADK,CACCf,EAAE,CAACgB,gBAAH,CACFC,GADE,CACE,UAACC,CAAD;AAAA,WAAQlB,EAAE,CAACmB,cAAH,CAAkBD,CAAlB,EAAqB,MAArB,EAA6B,GAA7B,CAAR;AAAA,GADF,CADD,CAAd;AAAA,MAGIE,MAAM,GAAGpB,EAAE,CAACoB,MAAH,CAAU,IAAV,CAHb;AAAA,MAIIC,OAAO,GAAGrB,EAAE,CAACqB,OAAH,GACLC,IADK,CACA,CAACpB,KAAD,EAAQE,MAAR,CADA,EAELmB,YAFK,CAEQ,CAFR,CAJd;AAQAhC,EAAAA,WAAW,CAACiC,SAAZ,GAAwBZ,IAAI,CAACa,IAA7B;;AAEA,MAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,CAAD,EAAO;AACzBnB,IAAAA,OAAO,CAACE,KAAR,CAAc,SAAd,EAAyB,EAAzB,EACKP,IADL,CACU,YADV,EACwBwB,CAAC,CAACf,IAAF,CAAOgB,KAD/B,EAEKlB,KAFL,CAEW,MAFX,EAEoBV,EAAE,CAAC6B,KAAH,CAASC,KAAT,GAAiBrD,MAAM,CAAC,CAAD,CAAxB,GAA+B,IAFlD,EAGKiC,KAHL,CAGW,KAHX,EAGmBV,EAAE,CAAC6B,KAAH,CAASE,KAAT,GAAiBtD,MAAM,CAAC,CAAD,CAAxB,GAA+B,IAHjD,EAIKuD,IAJL,CAKQ,WAAWL,CAAC,CAACf,IAAF,CAAOa,IAAlB,GAAyB,MAAzB,GACE,YADF,GACiBE,CAAC,CAACf,IAAF,CAAOqB,QADxB,GACmC,MADnC,GAEE,SAFF,GAEcN,CAAC,CAACf,IAAF,CAAOgB,KAP7B;AASD,GAVD;;AAWA,MAAMM,WAAW,GAAG,SAAdA,WAAc,CAACP,CAAD,EAAO;AACzBnB,IAAAA,OAAO,CAACE,KAAR,CAAc,SAAd,EAAyB,CAAzB;AACD,GAFD,CAtB0B,CA0B1B;;;AACA,MAAIyB,IAAI,GAAGnC,EAAE,CAACoC,SAAH,CAAaxB,IAAb,EACNyB,UADM,CACK,UAACV,CAAD,EAAO;AACjBA,IAAAA,CAAC,CAACf,IAAF,CAAO0B,EAAP,GAAY,CAACX,CAAC,CAACY,MAAF,GAAWZ,CAAC,CAACY,MAAF,CAAS3B,IAAT,CAAc0B,EAAd,GAAmB,GAA9B,GAAoC,EAArC,IAA2CX,CAAC,CAACf,IAAF,CAAOa,IAA9D;AACD,GAHM,EAINe,GAJM,CAIF,UAACb,CAAD;AAAA,WAAOA,CAAC,CAACC,KAAT;AAAA,GAJE,EAKNa,IALM,CAKD,UAACC,CAAD,EAAIC,CAAJ;AAAA,WAAUA,CAAC,CAACf,KAAF,GAAUc,CAAC,CAACd,KAAZ,IAAqBe,CAAC,CAACvC,MAAF,GAAWsC,CAAC,CAACtC,MAA5C;AAAA,GALC,CAAX;AAOAiB,EAAAA,OAAO,CAACc,IAAD,CAAP,CAlC0B,CAoC1B;;AACA,MAAMS,IAAI,GAAG7C,QAAQ,CAAC8C,SAAT,CAAmB,GAAnB,EACRjC,IADQ,CACHuB,IAAI,CAACW,MAAL,EADG,EAERC,KAFQ,GAEAtC,MAFA,CAEO,GAFP,EAGRN,IAHQ,CAGH,OAHG,EAGM,OAHN,EAIRA,IAJQ,CAIH,WAJG,EAIU,UAACwB,CAAD;AAAA,WAAO,eAAeA,CAAC,CAACqB,EAAjB,GAAsB,GAAtB,GAA4BrB,CAAC,CAACsB,EAA9B,GAAmC,GAA1C;AAAA,GAJV,CAAb,CArC0B,CA2C1B;;AACAL,EAAAA,IAAI,CAACnC,MAAL,CAAY,MAAZ,EACKN,IADL,CACU,IADV,EACgB,UAACwB,CAAD;AAAA,WAAOA,CAAC,CAACf,IAAF,CAAO0B,EAAd;AAAA,GADhB,EAEKnC,IAFL,CAEU,OAFV,EAEmB,MAFnB,EAGKA,IAHL,CAGU,OAHV,EAGmB,UAACwB,CAAD;AAAA,WAAOA,CAAC,CAACuB,EAAF,GAAOvB,CAAC,CAACqB,EAAhB;AAAA,GAHnB,EAIK7C,IAJL,CAIU,QAJV,EAIoB,UAACwB,CAAD;AAAA,WAAOA,CAAC,CAACwB,EAAF,GAAOxB,CAAC,CAACsB,EAAhB;AAAA,GAJpB,EAKK9C,IALL,CAKU,WALV,EAKuB,UAACwB,CAAD;AAAA,WAAOA,CAAC,CAACf,IAAF,CAAOa,IAAd;AAAA,GALvB,EAMKtB,IANL,CAMU,eANV,EAM2B,UAACwB,CAAD;AAAA,WAAOA,CAAC,CAACf,IAAF,CAAOqB,QAAd;AAAA,GAN3B,EAOK9B,IAPL,CAOU,YAPV,EAOwB,UAACwB,CAAD;AAAA,WAAOA,CAAC,CAACf,IAAF,CAAOgB,KAAd;AAAA,GAPxB,EAQKzB,IARL,CAQU,MARV,EAQkB,UAACwB,CAAD;AAAA,WAAOd,KAAK,CAACc,CAAC,CAACf,IAAF,CAAOqB,QAAR,CAAZ;AAAA,GARlB,EASKmB,EATL,CASQ,WATR,EASqB1B,WATrB,EAUK0B,EAVL,CAUQ,UAVR,EAUoBlB,WAVpB,EA5C0B,CAwD1B;;AACAU,EAAAA,IAAI,CAACnC,MAAL,CAAY,MAAZ,EACKN,IADL,CACU,OADV,EACmB,WADnB,EAEK0C,SAFL,CAEe,OAFf,EAGKjC,IAHL,CAGU,UAACe,CAAD;AAAA,WAAOA,CAAC,CAACf,IAAF,CAAOa,IAAP,CAAY4B,KAAZ,CAAkB,kBAAlB,CAAP;AAAA,GAHV,EAIKN,KAJL,GAIatC,MAJb,CAIoB,OAJpB,EAKKN,IALL,CAKU,GALV,EAKe1B,MAAM,CAAC,GAAD,CALrB,EAMK0B,IANL,CAMU,GANV,EAMe,UAACwB,CAAD,EAAI2B,CAAJ;AAAA,WAAU7E,MAAM,CAAC,GAAD,CAAN,GAAc6E,CAAC,GAAG7E,MAAM,CAAC,GAAD,CAAlC;AAAA,GANf,EAOK8E,IAPL,CAOU,UAAC5B,CAAD;AAAA,WAAOA,CAAP;AAAA,GAPV,EAQKyB,EARL,CAQQ,WARR,EAQqB1B,WARrB,EASK0B,EATL,CASQ,UATR,EASoBlB,WATpB,EAzD0B,CAoE1B;;AACA,MAAMsB,UAAU,GAAGrB,IAAI,CAACW,MAAL,GACd7B,GADc,CACV,UAACwC,KAAD;AAAA,WAAWA,KAAK,CAAC7C,IAAN,CAAWqB,QAAtB;AAAA,GADU,EAEdyB,MAFc,CAEP,UAACzB,QAAD,EAAW0B,KAAX,EAAkBC,IAAlB;AAAA,WAA2BA,IAAI,CAACC,OAAL,CAAa5B,QAAb,MAA2B0B,KAAtD;AAAA,GAFO,CAAnB;AAIA,MAAMG,oBAAoB,GAAGC,IAAI,CAACC,KAAL,CAAWzD,WAAW,GAAGf,UAAU,CAACK,QAApC,CAA7B;AAEA,MAAMoE,aAAa,GAAG3D,MAAM,CACvBG,MADiB,CACV,GADU,EAEjBN,IAFiB,CAEZ,WAFY,EAEC,kBAAkBX,UAAU,CAACC,MAA7B,GAAsC,GAFvC,EAGjBoD,SAHiB,CAGP,GAHO,EAIjBjC,IAJiB,CAIZ4C,UAJY,EAKjBT,KALiB,GAKTtC,MALS,CAKF,GALE,EAMjBN,IANiB,CAMZ,WANY,EAMC,UAACwB,CAAD,EAAI2B,CAAJ;AAAA,WAAU,eACrBA,CAAC,GAAGQ,oBAAL,GAA6BtE,UAAU,CAACK,QADlB,GAEvB,GAFuB,IAGrBkE,IAAI,CAACC,KAAL,CAAWV,CAAC,GAAGQ,oBAAf,CAAD,GACEtE,UAAU,CAACI,QADb,GAEGJ,UAAU,CAACM,QAAX,GAAuBiE,IAAI,CAACC,KAAL,CAAWV,CAAC,GAAGQ,oBAAf,CALJ,IAMvB,GANa;AAAA,GAND,CAAtB;AAeAG,EAAAA,aAAa,CAACxD,MAAd,CAAqB,MAArB,EACKN,IADL,CACU,OADV,EACmBX,UAAU,CAACI,QAD9B,EAEKO,IAFL,CAEU,QAFV,EAEoBX,UAAU,CAACI,QAF/B,EAGKO,IAHL,CAGU,OAHV,EAGmB,aAHnB,EAIKA,IAJL,CAIU,MAJV,EAIkB,UAACwB,CAAD;AAAA,WAAOd,KAAK,CAACc,CAAD,CAAZ;AAAA,GAJlB;AAMAsC,EAAAA,aAAa,CAACxD,MAAd,CAAqB,MAArB,EACKN,IADL,CACU,GADV,EACeX,UAAU,CAACI,QAAX,GAAsBJ,UAAU,CAACE,OADhD,EAEKS,IAFL,CAEU,GAFV,EAEeX,UAAU,CAACI,QAAX,GAAsBJ,UAAU,CAACG,OAFhD,EAGK4D,IAHL,CAGU,UAAC5B,CAAD;AAAA,WAAOA,CAAP;AAAA,GAHV;AAID,CApGD,C,CAsGA;;;AACA,IAAMuC,WAAW,GAAG,SAAdA,WAAc,CAACC,KAAD,EAAW;AAC7B;AACAjF,EAAAA,KAAK,CAACsC,SAAN,GAAkBxC,KAAK,CAACmF,KAAD,CAAL,CAAajF,KAA/B,CAF6B,CAI7B;;AACAc,EAAAA,EAAE,CAACoE,IAAH,CAAQpF,KAAK,CAACmF,KAAD,CAAL,CAAahF,GAArB,EACKkF,IADL,CACU,UAACzD,IAAD;AAAA,WAAUD,SAAS,CAACC,IAAD,CAAnB;AAAA,GADV;AAED,CAPD,C,CASA;;;AACA,IAAM0D,KAAK,GAAGzF,QAAQ,CAAC0F,sBAAT,CAAgC,UAAhC,CAAd;AACAC,KAAK,CAACC,IAAN,CAAWH,KAAX,EAAkBI,OAAlB,CAA0B,UAACC,OAAD;AAAA,SACtBA,OAAO,CAACC,gBAAR,CAAyB,OAAzB,EAAkC,UAACC,CAAD,EAAO;AACvCA,IAAAA,CAAC,CAACC,cAAF;AACA,QAAMC,aAAa,GAAG,IAAIC,GAAJ,CAAQH,CAAC,CAACI,MAAF,CAASC,IAAjB,CAAtB;AACA,QAAMC,QAAQ,GAAGJ,aAAa,CAACK,YAAd,CAA2BC,GAA3B,CAA+B,MAA/B,KAA0C,MAA3D;AACAtF,IAAAA,QAAQ,CAAC8C,SAAT,CAAmB,GAAnB,EAAwByC,MAAxB;AACAhF,IAAAA,MAAM,CAACuC,SAAP,CAAiB,GAAjB,EAAsByC,MAAtB;AAEApB,IAAAA,WAAW,CAACiB,QAAD,CAAX;AACD,GARD,CADsB;AAAA,CAA1B,E,CAYA;;AACA,IAAMI,QAAQ,GAAG,IAAIP,GAAJ,CAAQQ,MAAM,CAACC,QAAf,CAAjB;AACA,IAAMC,SAAS,GAAGH,QAAQ,CAACH,YAAT,CAAsBC,GAAtB,CAA0B,MAA1B,KAAqC,MAAvD;AAEAnB,WAAW,CAACwB,SAAD,CAAX","sourceRoot":".","sourcesContent":["\"use strict\";\nconst projectName = \"tree-map\";\nlocalStorage.setItem('example_project', 'D3: Tree Map');\n\nconst rem2px = (rem) => (rem * parseFloat(getComputedStyle(document.documentElement).fontSize));\n\nconst FILES = {\n  kickstarter: {\n    title: \"Kickstarter Pledges\",\n    url: \"https://cdn.rawgit.com/freeCodeCamp/testable-projects-fcc/a80ce8f9/src/data/tree_map/kickstarter-funding-data.json\"\n  },\n  movie: {\n    title: \"Movie Sales\",\n    url: \"https://cdn.rawgit.com/freeCodeCamp/testable-projects-fcc/a80ce8f9/src/data/tree_map/movie-data.json\"\n  },\n  game: {\n    title: \"Video Game Sales\",\n    url: \"https://cdn.rawgit.com/freeCodeCamp/testable-projects-fcc/a80ce8f9/src/data/tree_map/video-game-sales-data.json\"\n  }\n};\n\nconst title = document.getElementById('title'),\n    description = document.getElementById('description'),\n    legendSize = {\n      offset: rem2px(0.5),\n      xOffset: 3,\n      yOffset: -2,\n      rectSize: rem2px(0.8),\n      hSpacing: rem2px(10),\n      vSpacing: rem2px(0.5),\n    };\n\nlet svgChart = d3.select(\"#tree-map\"),\n    width = +svgChart.attr(\"width\"),\n    height = +svgChart.attr(\"height\"),\n    body = d3.select('body'),\n    legend = d3.select(\"#legend\"),\n    legendWidth = +legend.attr(\"width\");\n\nlet tooltip = body.append(\"div\")\n    .attr(\"id\", \"tooltip\")\n    .style(\"opacity\", 0);\n\n\nconst d3Process = (data) => {\n  const color = d3.scaleOrdinal()\n          .range(d3.schemeCategory10\n              .map((c) => (d3.interpolateRgb(c, \"#ccc\")(0.1)))),\n      format = d3.format(',d'),\n      treemap = d3.treemap()\n          .size([width, height])\n          .paddingInner(1);\n\n  description.innerHTML = data.name;\n\n  const showTooltip = (d) => {\n    tooltip.style(\"opacity\", .9)\n        .attr(\"data-value\", d.data.value)\n        .style(\"left\", (d3.event.pageX + rem2px(1)) + \"px\")\n        .style(\"top\", (d3.event.pageY + rem2px(1)) + \"px\")\n        .html(\n            'Name: ' + d.data.name + '<br>'\n            + 'Category: ' + d.data.category + '<br>'\n            + 'Value: ' + d.data.value\n        );\n  };\n  const hideTooltip = (d) => {\n    tooltip.style(\"opacity\", 0);\n  };\n\n  // Create Root tree.\n  let root = d3.hierarchy(data)\n      .eachBefore((d) => {\n        d.data.id = (d.parent ? d.parent.data.id + \".\" : \"\") + d.data.name;\n      })\n      .sum((d) => d.value)\n      .sort((a, b) => b.value - a.value || b.height - a.height);\n\n  treemap(root);\n\n  // Create cells.\n  const cell = svgChart.selectAll(\"g\")\n      .data(root.leaves())\n      .enter().append(\"g\")\n      .attr(\"class\", \"group\")\n      .attr(\"transform\", (d) => \"translate(\" + d.x0 + \",\" + d.y0 + \")\");\n\n  // Create tiles.\n  cell.append(\"rect\")\n      .attr(\"id\", (d) => d.data.id)\n      .attr(\"class\", \"tile\")\n      .attr(\"width\", (d) => d.x1 - d.x0)\n      .attr(\"height\", (d) => d.y1 - d.y0)\n      .attr(\"data-name\", (d) => d.data.name)\n      .attr(\"data-category\", (d) => d.data.category)\n      .attr(\"data-value\", (d) => d.data.value)\n      .attr(\"fill\", (d) => color(d.data.category))\n      .on(\"mouseover\", showTooltip)\n      .on(\"mouseout\", hideTooltip);\n\n  // Add Tile Texts.\n  cell.append(\"text\")\n      .attr('class', 'tile-text')\n      .selectAll(\"tspan\")\n      .data((d) => d.data.name.split(/(?=[A-Z][^A-Z])/g))\n      .enter().append(\"tspan\")\n      .attr(\"x\", rem2px(0.1))\n      .attr(\"y\", (d, i) => rem2px(0.7) + i * rem2px(0.7))\n      .text((d) => d)\n      .on(\"mouseover\", showTooltip)\n      .on(\"mouseout\", hideTooltip);\n\n  // Create Legend.\n  const categories = root.leaves()\n      .map((nodes) => nodes.data.category)\n      .filter((category, index, self) => self.indexOf(category) === index);\n\n  const legendElementsPerRow = Math.floor(legendWidth / legendSize.hSpacing);\n\n  const legendElement = legend\n      .append(\"g\")\n      .attr(\"transform\", \"translate(60,\" + legendSize.offset + \")\")\n      .selectAll(\"g\")\n      .data(categories)\n      .enter().append(\"g\")\n      .attr(\"transform\", (d, i) => 'translate(' +\n            ((i % legendElementsPerRow) * legendSize.hSpacing)\n          + ',' +\n            ((Math.floor(i / legendElementsPerRow))\n             * legendSize.rectSize\n             + (legendSize.vSpacing * (Math.floor(i / legendElementsPerRow))))\n          + ')'\n      );\n\n  legendElement.append(\"rect\")\n      .attr('width', legendSize.rectSize)\n      .attr('height', legendSize.rectSize)\n      .attr('class', 'legend-item')\n      .attr('fill', (d) => color(d));\n\n  legendElement.append(\"text\")\n      .attr('x', legendSize.rectSize + legendSize.xOffset)\n      .attr('y', legendSize.rectSize + legendSize.yOffset)\n      .text((d) => d);\n};\n\n// Creates a Chart on start or on Menu Click.\nconst createChart = (query) => {\n  // Set title.\n  title.innerHTML = FILES[query].title;\n\n  // Create Chart.\n  d3.json(FILES[query].url)\n      .then((data) => d3Process(data));\n};\n\n// Add listener for \"smoother\" menu-click.\nconst links = document.getElementsByClassName('nav-link');\nArray.from(links).forEach((element) =>\n    element.addEventListener('click', (e) => {\n      e.preventDefault();\n      const targetDataUrl = new URL(e.target.href);\n      const newQuery = targetDataUrl.searchParams.get(\"data\") || 'game';\n      svgChart.selectAll('*').remove();\n      legend.selectAll('*').remove();\n\n      createChart(newQuery);\n    })\n);\n\n// Get Parameter.\nconst queryUrl = new URL(window.location);\nconst dataQuery = queryUrl.searchParams.get(\"data\") || 'game';\n\ncreateChart(dataQuery);"],"file":"d3tm.js"}