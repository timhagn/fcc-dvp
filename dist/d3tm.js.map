{"version":3,"sources":["../d3tm.js"],"names":["projectName","localStorage","setItem","rem2px","rem","parseFloat","getComputedStyle","document","documentElement","fontSize","FILES","container","getElementById","description","margin","top","right","bottom","left","padding","width","offsetWidth","height","offsetHeight","x","d3","scaleLinear","domain","rangeRound","color","scaleThreshold","range","schemeBlues","path","geoPath","chart","select","svgChart","append","attr","tooltip","style","legend","selectAll","data","map","d","invertExtent","enter","Math","abs","text","call","axisBottom","tickSize","tickFormat","round","tickValues","remove","Promise","all","url","json","then","d3Process","us","hasOwnProperty","education","topojson","feature","objects","counties","features","id","result","filter","obj","fips","bachelorsOrHigher","console","log","on","html","area_name","state","mouseX","event","pageX","node","getBoundingClientRect","mouseY","pageY","y","datum","mesh","states","a","b"],"mappings":"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","sourceRoot":".","sourcesContent":["const projectName=\"tree-map\"\nlocalStorage.setItem('example_project', 'D3: Tree Map');\n\nconst rem2px = (rem) => (rem * parseFloat(getComputedStyle(document.documentElement).fontSize));\n\nconst FILES = [\n    'https://raw.githubusercontent.com/no-stack-dub-sack/testable-projects-fcc/master/src/data/choropleth_map/for_user_education.json',\n    'https://raw.githubusercontent.com/no-stack-dub-sack/testable-projects-fcc/master/src/data/choropleth_map/counties.json'\n];\n\nlet container = document.getElementById('container'),\n    description = document.getElementById('description'),\n    margin = {\n      top: rem2px(1),\n      right: rem2px(1),\n      bottom: rem2px(4),\n      left: rem2px(1)\n    },\n    padding = {\n      top: rem2px(4.5),\n      right: rem2px(1),\n      bottom: rem2px(1),\n      left: rem2px(1),\n    },\n    width = container.offsetWidth\n        - margin.left - margin.right\n        - padding.left - padding.right,\n    height = container.offsetHeight\n        - margin.top - margin.bottom\n        - padding.top - padding.bottom;\n\nwidth = width < 960 ? 960 : width;\n\nconst x = d3.scaleLinear()\n        .domain([2.6, 75.1])\n        .rangeRound([height, width]),\n      color = d3.scaleThreshold()\n        .domain(d3.range(2.6, 75.1, (75.1-2.6)/8))\n        .range(d3.schemeBlues[9]),\n      path = d3.geoPath();\n\nlet chart = d3.select('.chart');\n\nlet svgChart = chart.append(\"svg\")\n    .attr(\"width\", width + margin.left + margin.right)\n    .attr(\"height\", height + margin.top + padding.bottom);\n\nlet tooltip = chart.append('div')\n    .attr('id', 'tooltip')\n    .style('opacity', 0);\n\nlet legend = svgChart.append(\"g\")\n    .attr(\"class\", \"key\")\n    .attr(\"id\", \"legend\")\n    .attr(\"transform\", \"translate(0,40)\")\n\nlegend.selectAll(\"rect\")\n    .data(color.range().map((d) => {\n      d = color.invertExtent(d);\n      if (d[0] == null) d[0] = x.domain()[0];\n      if (d[1] == null) d[1] = x.domain()[1];\n      return d;\n    }))\n    .enter().append(\"rect\")\n    .attr(\"height\", 8)\n    .attr(\"x\", (d) => x(d[0]))\n    .attr(\"width\", (d) => Math.abs(x(d[1]) - x(d[0])))\n    .attr(\"fill\", (d) =>  color(d[0]));\n\nlegend.append(\"text\")\n    .attr(\"class\", \"caption\")\n    .attr(\"x\", x.range()[0])\n    .attr(\"y\", -6)\n    .attr(\"fill\", \"#000\")\n    .attr(\"text-anchor\", \"start\")\n    .attr(\"font-weight\", \"bold\")\n    .text(\"Educational Attainment\");\n\nlegend.call(d3.axisBottom(x)\n    .tickSize(13)\n    .tickFormat((x) => Math.round(x) + '%')\n    .tickValues(color.domain()))\n    .select(\".domain\")\n    .remove();\n\n// Create Chart promisified.\nPromise.all(FILES.map(url => d3.json(url)))\n    .then((data) => d3Process(data));\n\nconst d3Process = (data) => {\n  // Fill US & Education Array from data.\n  const us = data[0].hasOwnProperty('type') ? data[0] : data[1];\n  const education = data[0].hasOwnProperty('type') ? data[1] : data[0];\n\n  // Add counties.\n  svgChart.append(\"g\")\n      .attr(\"class\", \"counties\")\n      .selectAll(\"path\")\n      .data(topojson.feature(us, us.objects.counties).features)\n      .enter().append(\"path\")\n      .attr(\"class\", \"county\")\n      .attr(\"data-fips\", (d) => d.id)\n      .attr(\"data-education\", (d) => {\n        let result = education.filter(function( obj ) {\n          return obj.fips === d.id;\n        });\n        if(result[0]){\n          return result[0].bachelorsOrHigher\n        }\n        // Could not find a matching fips-id in the data.\n        console.log(\"Couldn't find data for: \", d.id);\n        return 0\n      })\n      .attr(\"fill\", (d) => {\n        let result = education.filter(function( obj ) {\n          return obj.fips === d.id;\n        });\n        if(result[0]){\n          return color(result[0].bachelorsOrHigher)\n        }\n        // Could not find a matching color in the Data.\n        return color(0)\n      })\n      .attr(\"d\", path)\n      .on(\"mouseover\", (d) => {\n        let result = education.filter(function( obj ) {\n          return obj.fips === d.id;\n        });\n        if(result[0]) {\n          tooltip.style(\"opacity\", .9);\n          tooltip.attr(\"data-education\", result[0].bachelorsOrHigher);\n          tooltip.html(result[0].area_name\n              + \", \" + result[0].state\n              + \": \" + result[0].bachelorsOrHigher + \"%\");\n\n          // Calculate x and y positions for tooltip.\n          let mouseX = d3.event.pageX - svgChart.node().getBoundingClientRect().x + 10,\n              mouseY = d3.event.pageY - svgChart.node().getBoundingClientRect().y + 10,\n              y = mouseY + tooltip.node().offsetHeight + rem2px(1) > height ?\n                  mouseY - tooltip.node().offsetHeight / 2 + rem2px(1)\n                  : mouseY + tooltip.node().offsetHeight + rem2px(1),\n              x = mouseX - tooltip.node().offsetWidth / 2 > width ?\n                  mouseX - tooltip.node().offsetWidth + rem2px(1)\n                  : mouseX - tooltip.node().offsetWidth / 2 + rem2px(1);\n          if (x < 0) {\n            x = mouseX;\n          }\n          tooltip.style(\"left\", (x) + \"px\")\n              .style(\"top\", (y) + \"px\");\n        }\n      })\n      .on(\"mouseout\", (d) => {\n        tooltip.style(\"opacity\", 0);\n      });\n\n  // Add states.\n  svgChart.append(\"path\")\n      .datum(topojson.mesh(us, us.objects.states, (a, b) => a !== b))\n      .attr(\"class\", \"states\")\n      .attr(\"d\", path);\n};\n\n\n"],"file":"d3tm.js"}