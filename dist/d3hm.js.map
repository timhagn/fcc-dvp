{"version":3,"sources":["../d3hm.js"],"names":["projectName","localStorage","setItem","rem2px","rem","parseFloat","getComputedStyle","document","documentElement","fontSize","container","getElementById","description","margin","top","right","bottom","left","padding","width","offsetWidth","height","offsetHeight","x","d3","scaleLinear","range","y","scaleTime","timeFormat","xAxis","axisBottom","tickFormat","format","yAxis","axisLeft","chart","select","svgChart","append","attr","tooltip","style","d3Process","data","monthly","monthlyVariance","baseTemperature","minYear","min","d","year","maxYear","max","rectWidth","forEach","month","temperature","variance","colorDomain","extent","map","each","colors","colorRange","scaleQuantile","domain","innerHTML","Date","call","selectAll","text","classed","enter","i","toLocaleString","on","html","mouseX","event","pageX","node","getBoundingClientRect","mouseY","pageY","legendWidth","legendHeight","length","minTemp","Math","apply","maxTemp","legendThreshold","scaleThreshold","count","array","step","push","legendX","legendXAxis","tickSize","tickValues","legend","color","invertExtent","json","then"],"mappings":"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","sourceRoot":".","sourcesContent":["const projectName = 'heat-map';\nlocalStorage.setItem('example_project', 'D3: Heat Map');\n\nconst rem2px = (rem) => (rem * parseFloat(getComputedStyle(document.documentElement).fontSize));\n\n/*\n  padding-top: 4.5rem\n */\n\nlet container = document.getElementById('container'),\n    description = document.getElementById('description'),\n    margin = {\n      top: rem2px(1),\n      right: rem2px(1.5),\n      bottom: rem2px(1),\n      left: rem2px(4)\n    },\n    padding = {\n      top: rem2px(4.5),\n      right: rem2px(2),\n      bottom: rem2px(5),\n      left: rem2px(4),\n    },\n    width = container.offsetWidth\n        - margin.left - margin.right\n        - padding.left - padding.right,\n    height = container.offsetHeight\n        - margin.top - margin.bottom\n        - padding.top - padding.bottom;\n\nconst x = d3.scaleLinear()\n            .range([0, width]),\n      y = d3.scaleTime()\n            .range([0, height - padding.bottom]),\n      timeFormat = d3.timeFormat(\"%B\"),\n      xAxis = d3.axisBottom(x).tickFormat(d3.format(\"d\")),\n      yAxis = d3.axisLeft(y).tickFormat(timeFormat);\n\n\nlet chart = d3.select('.chart');\n\nlet svgChart = chart.append(\"svg\")\n    .attr(\"width\", width + margin.left + margin.right)\n    .attr(\"height\", height + margin.top + padding.bottom)\n    .append(\"g\")\n    .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\nlet tooltip = chart.append('div')\n    .attr('id', 'tooltip')\n    .style('opacity', 0);\n\nconst d3Process = (data) => {\n  let monthly = data.monthlyVariance,\n      baseTemperature = data.baseTemperature,\n      minYear = d3.min(monthly, (d) => d.year),\n      maxYear = d3.max(monthly, (d) =>  d.year),\n      rectWidth = (width / (maxYear - minYear));\n\n  monthly.forEach((d) => {\n    d.month -= 1;\n    d.temperature = data.baseTemperature + d.variance;\n  });\n\n  let colorDomain = d3.extent(monthly.map((each) => each.temperature)),\n      colors = [\"#5D2EE8\", \"#2F9EEE\", \"#2FC8EE\", \"#2DD91A\", \"#CBF22C\", \"#F2CE2C\", \"#F06E1D\", \"#E61717\"],\n      colorRange = d3.scaleQuantile().domain(colorDomain).range(colors);\n\n  description.innerHTML = minYear + ' - ' + maxYear\n      + ': Base Temperature: ' + baseTemperature + 'Â°C';\n\n  x.domain([minYear - 1,\n    maxYear + 1]);\n  y.domain([new Date(2017, 0, 1), new Date(2017, 11, 1)]);\n  svgChart.append(\"g\")\n      .attr(\"id\",\"x-axis\")\n      .attr(\"transform\", \"translate(0,\" + (height - rem2px(2.2)) + \")\")\n      .call(xAxis);\n\n  svgChart.append(\"g\")\n      .attr(\"id\",\"y-axis\")\n      .call(yAxis)\n      .selectAll(\".tick text\")\n      .style(\"text-anchor\", \"end\")\n      .attr(\"x\", -12)\n      .attr(\"y\", 12);\n\n  svgChart.append('text')\n      .attr('transform', 'rotate(-90)')\n      .attr('x', -height/2)\n      .attr('y', -50)\n      .style('font-size', rem2px(1.2))\n      .text('Months');\n\n  y.domain(d3.extent(monthly, function(d) { return d.month; }));\n\n  svgChart.append(\"g\")\n      .classed(\"map\", true)\n      .selectAll(\"rect\")\n      .data(monthly)\n      .enter().append(\"rect\")\n      .attr(\"class\", \"cell\")\n      .attr(\"x\", function(d,i){\n          return x(d.year);\n        })\n      .attr(\"y\", function(d,i){\n          return y(d.month);\n        })\n      .attr(\"width\", rectWidth)\n      .attr(\"height\", (height) / 12)\n      .attr(\"data-year\", (d) => d.year)\n      .attr(\"data-month\", (d) => d.month.toLocaleString())\n      .attr(\"data-temp\", (d) => d.temperature)\n      .style(\"fill\", (d) => colorRange(d.temperature))\n      .on(\"mouseover\", (d) => {\n        tooltip.style(\"opacity\", .9);\n        tooltip.attr(\"data-year\", d.year);\n        tooltip.html(\"Year: \" +  d.year\n            + \", Month: \" + timeFormat(new Date(2017, d.month, 1)) + \"<br/><br/>\"\n            + \"Temperature: \" + d3.format(\".1f\")(d.temperature) + \"<br/>\"\n            + \"Variance: \" + d3.format(\"+.1f\")(d.variance));\n\n        // Calculate x and y positions for tooltip.\n        let mouseX = d3.event.pageX - svgChart.node().getBoundingClientRect().x + 10,\n            mouseY = d3.event.pageY - svgChart.node().getBoundingClientRect().y + 10,\n            y = mouseY + tooltip.node().offsetHeight + rem2px(1) > height ?\n                mouseY - tooltip.node().offsetHeight / 2 + rem2px(1)\n                : mouseY + tooltip.node().offsetHeight + rem2px(1),\n            x = mouseX - tooltip.node().offsetWidth / 2 > width ?\n                mouseX - tooltip.node().offsetWidth + rem2px(1)\n                : mouseX - tooltip.node().offsetWidth / 2 + rem2px(1);\n        if (x < 0) {\n          x = mouseX;\n        }\n        tooltip.style(\"left\", (x) + \"px\")\n               .style(\"top\", (y) + \"px\");\n      })\n      .on(\"mouseout\", (d) => {\n        tooltip.style(\"opacity\", 0);\n      });\n\n\n  // I adapted the legend to v5.\n  const legendWidth = 250,\n        legendHeight = 250 / colors.length;\n\n  const variance = monthly.map((d) => d.variance);\n\n  const minTemp = baseTemperature + Math.min.apply(null, variance);\n  const maxTemp = baseTemperature + Math.max.apply(null, variance);\n\n  const legendThreshold = d3.scaleThreshold()\n      .domain(((min,max,count) => {\n        let array = [];\n        let step = (max-min)/count;\n        for(let i = 1; i < count; i++){\n          array.push(min + i*step);\n        }\n        return array;\n      })(minTemp, maxTemp, colors.length))\n      .range(colors);\n\n  const legendX = d3.scaleLinear()\n      .domain([minTemp, maxTemp])\n      .range([0, legendWidth]);\n\n  const legendXAxis = d3.axisBottom(legendX)\n      .tickSize(10, 0)\n      .tickValues(legendThreshold.domain())\n      .tickFormat(d3.format(\".1f\"));\n\n  const legend = d3.select(\"svg\").append(\"g\")\n      .classed(\"legend\", true)\n      .attr(\"id\", \"legend\")\n      .attr(\"width\", legendWidth)\n      .attr(\"height\", legendHeight)\n      .attr(\"transform\", \"translate(\" + (padding.left) + \",\"\n          + (height + legendHeight / 2) + \")\");\n\n  legend.append(\"g\")\n      .selectAll(\"rect\")\n      .data(legendThreshold.range().map((color) => {\n        let d = legendThreshold.invertExtent(color);\n        if (d[0] == null) d[0] = legendX.domain()[0];\n        if (d[1] == null) d[1] = legendX.domain()[1];\n        return d;\n      }))\n      .enter().append(\"rect\")\n      .style(\"fill\", (d, i) => legendThreshold(d[0]))\n      .attr(\"x\", (d, i) => legendX(d[0]))\n      .attr(\"y\", 0)\n      .attr(\"width\", (d, i) => legendX(d[1]) - legendX(d[0]))\n      .attr(\"height\", legendHeight);\n\n  legend.append(\"g\")\n      .attr(\"transform\", \"translate(0, \" + legendHeight + \")\")\n      .call(legendXAxis);\n\n};\n\n// Create Chart.\nd3.json('https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/global-temperature.json')\n    .then((data) => d3Process(data));"],"file":"d3hm.js"}